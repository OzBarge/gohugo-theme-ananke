{{- $context := . -}}
{{- $config := site.Params.ananke.social -}}

<div class="ananke-socials">
  {{- range $config.follow.networks -}}
    {{- $network := . -}}
    {{- $profile := collections.Index $config.networks $network -}}

    {{- $rel := $profile.rel | compare.Default "" -}}
    {{- $label := $profile.label | compare.Default $network -}}

    {{- $link := $profile.profile -}}
    {{- with $profile.username -}}
      {{- $link = printf $link . -}}
    {{- end -}}
    {{- with $profile.profilelink -}}
      {{- $link = . -}} {{/* Use profilelink if defined */}}
    {{- end -}}

    {{- $languageDirection := compare.Conditional (compare.Eq $.Site.Language.LanguageDirection "rtl") "ml1" "mr1" -}}
    <a href="{{ $link }}" target="_blank" rel="noopener{{- with $rel }} {{ . -}}{{- end -}}"
       class="ananke-social-link link-transition {{ $network }} link dib z-999 pt3 pt0-l {{ $languageDirection }}"
       title="follow on {{ $label }} - Opens in a new window"
       aria-label="follow on {{ $label }} - Opens in a new window">
      
      {{- with $profile.icon -}}
        {{- $icon := resources.Get (printf "ananke/socials/%s.svg" .) -}}
        {{- with $icon -}}
          <span class="icon">
            {{ .Content | safe.HTML }}
          </span>
        {{- end -}}
      {{- else -}}
        {{- $label -}}
      {{- end -}}

      {{- with $config.follow.new_window_icon -}}
        {{- partials.Include "new-window-icon.html" . -}}
      {{- end -}}
    </a>
  {{- end -}}
</div>
